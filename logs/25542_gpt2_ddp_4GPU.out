Current working directory: /scratch/zl5604/project

Current working directory: /scratch/zl5604/project

Current working directory: /scratch/zl5604/project

Current working directory: /scratch/zl5604/project

TensorBoard logs path: ./tb_logsTensorBoard logs path: ./tb_logsTensorBoard logs path: ./tb_logs
TensorBoard logs path: ./tb_logs


World Size:  4
World Size:  4
World Size:  4
World Size:  4
local rank: 2
local rank: 1
local rank: 3
local rank: 0
b-33-25:6462:6462 [0] NCCL INFO NCCL_SOCKET_IFNAME set by environment to ^lo,docker
b-33-25:6462:6462 [0] NCCL INFO Bootstrap : Using eth0:10.144.0.14<0>
b-33-25:6462:6462 [0] NCCL INFO NET/Plugin: No plugin found (libnccl-net.so)
b-33-25:6462:6462 [0] NCCL INFO NET/Plugin: Plugin load returned 2 : libnccl-net.so: cannot open shared object file: No such file or directory : when loading libnccl-net.so
b-33-25:6462:6462 [0] NCCL INFO NET/Plugin: Using internal network plugin.
b-33-25:6462:6462 [0] NCCL INFO cudaDriverVersion 12060
NCCL version 2.21.5+cuda12.1
b-33-25:6464:6464 [2] NCCL INFO cudaDriverVersion 12060
b-33-25:6463:6463 [1] NCCL INFO cudaDriverVersion 12060
b-33-25:6465:6465 [3] NCCL INFO cudaDriverVersion 12060
b-33-25:6463:6463 [1] NCCL INFO NCCL_SOCKET_IFNAME set by environment to ^lo,docker
b-33-25:6464:6464 [2] NCCL INFO NCCL_SOCKET_IFNAME set by environment to ^lo,docker
b-33-25:6465:6465 [3] NCCL INFO NCCL_SOCKET_IFNAME set by environment to ^lo,docker
b-33-25:6463:6463 [1] NCCL INFO Bootstrap : Using eth0:10.144.0.14<0>
b-33-25:6465:6465 [3] NCCL INFO Bootstrap : Using eth0:10.144.0.14<0>
b-33-25:6464:6464 [2] NCCL INFO Bootstrap : Using eth0:10.144.0.14<0>
b-33-25:6463:6463 [1] NCCL INFO NET/Plugin: No plugin found (libnccl-net.so)
b-33-25:6464:6464 [2] NCCL INFO NET/Plugin: No plugin found (libnccl-net.so)
b-33-25:6463:6463 [1] NCCL INFO NET/Plugin: Plugin load returned 2 : libnccl-net.so: cannot open shared object file: No such file or directory : when loading libnccl-net.so
b-33-25:6465:6465 [3] NCCL INFO NET/Plugin: No plugin found (libnccl-net.so)
b-33-25:6463:6463 [1] NCCL INFO NET/Plugin: Using internal network plugin.
b-33-25:6464:6464 [2] NCCL INFO NET/Plugin: Plugin load returned 2 : libnccl-net.so: cannot open shared object file: No such file or directory : when loading libnccl-net.so
b-33-25:6464:6464 [2] NCCL INFO NET/Plugin: Using internal network plugin.
b-33-25:6465:6465 [3] NCCL INFO NET/Plugin: Plugin load returned 2 : libnccl-net.so: cannot open shared object file: No such file or directory : when loading libnccl-net.so
b-33-25:6465:6465 [3] NCCL INFO NET/Plugin: Using internal network plugin.
b-33-25:6465:6587 [3] NCCL INFO NCCL_IB_DISABLE set by environment to 0.
b-33-25:6464:6589 [2] NCCL INFO NCCL_IB_DISABLE set by environment to 0.
b-33-25:6463:6588 [1] NCCL INFO NCCL_IB_DISABLE set by environment to 0.
b-33-25:6462:6586 [0] NCCL INFO NCCL_IB_DISABLE set by environment to 0.
b-33-25:6462:6586 [0] NCCL INFO NCCL_SOCKET_IFNAME set by environment to ^lo,docker
b-33-25:6464:6589 [2] NCCL INFO NCCL_SOCKET_IFNAME set by environment to ^lo,docker
b-33-25:6465:6587 [3] NCCL INFO NCCL_SOCKET_IFNAME set by environment to ^lo,docker
b-33-25:6463:6588 [1] NCCL INFO NCCL_SOCKET_IFNAME set by environment to ^lo,docker
b-33-25:6463:6588 [1] NCCL INFO NET/IB : No device found.
b-33-25:6463:6588 [1] NCCL INFO NCCL_SOCKET_IFNAME set by environment to ^lo,docker
b-33-25:6463:6588 [1] NCCL INFO NET/Socket : Using [0]eth0:10.144.0.14<0>
b-33-25:6463:6588 [1] NCCL INFO Using non-device net plugin version 0
b-33-25:6463:6588 [1] NCCL INFO Using network Socket
b-33-25:6465:6587 [3] NCCL INFO NET/IB : No device found.
b-33-25:6465:6587 [3] NCCL INFO NCCL_SOCKET_IFNAME set by environment to ^lo,docker
b-33-25:6464:6589 [2] NCCL INFO NET/IB : No device found.
b-33-25:6462:6586 [0] NCCL INFO NET/IB : No device found.
b-33-25:6464:6589 [2] NCCL INFO NCCL_SOCKET_IFNAME set by environment to ^lo,docker
b-33-25:6462:6586 [0] NCCL INFO NCCL_SOCKET_IFNAME set by environment to ^lo,docker
b-33-25:6465:6587 [3] NCCL INFO NET/Socket : Using [0]eth0:10.144.0.14<0>
b-33-25:6462:6586 [0] NCCL INFO NET/Socket : Using [0]eth0:10.144.0.14<0>
b-33-25:6464:6589 [2] NCCL INFO NET/Socket : Using [0]eth0:10.144.0.14<0>
b-33-25:6465:6587 [3] NCCL INFO Using non-device net plugin version 0
b-33-25:6465:6587 [3] NCCL INFO Using network Socket
b-33-25:6462:6586 [0] NCCL INFO Using non-device net plugin version 0
b-33-25:6462:6586 [0] NCCL INFO Using network Socket
b-33-25:6464:6589 [2] NCCL INFO Using non-device net plugin version 0
b-33-25:6464:6589 [2] NCCL INFO Using network Socket
b-33-25:6465:6587 [3] NCCL INFO ncclCommInitRank comm 0x5580c708c780 rank 3 nranks 4 cudaDev 3 nvmlDev 3 busId 60 commId 0xe9a19da4e79a4a87 - Init START
b-33-25:6463:6588 [1] NCCL INFO ncclCommInitRank comm 0x557c9fac8540 rank 1 nranks 4 cudaDev 1 nvmlDev 1 busId 40 commId 0xe9a19da4e79a4a87 - Init START
b-33-25:6464:6589 [2] NCCL INFO ncclCommInitRank comm 0x56382c525e80 rank 2 nranks 4 cudaDev 2 nvmlDev 2 busId 50 commId 0xe9a19da4e79a4a87 - Init START
b-33-25:6462:6586 [0] NCCL INFO ncclCommInitRank comm 0x55da8c205640 rank 0 nranks 4 cudaDev 0 nvmlDev 0 busId 30 commId 0xe9a19da4e79a4a87 - Init START
b-33-25:6465:6587 [3] NCCL INFO Setting affinity for GPU 3 to ffff,ffffffff
b-33-25:6465:6587 [3] NCCL INFO NVLS multicast support is not available on dev 3
b-33-25:6464:6589 [2] NCCL INFO Setting affinity for GPU 2 to ffff,ffffffff
b-33-25:6464:6589 [2] NCCL INFO NVLS multicast support is not available on dev 2
b-33-25:6462:6586 [0] NCCL INFO Setting affinity for GPU 0 to ffff,ffffffff
b-33-25:6462:6586 [0] NCCL INFO NVLS multicast support is not available on dev 0
b-33-25:6463:6588 [1] NCCL INFO Setting affinity for GPU 1 to ffff,ffffffff
b-33-25:6463:6588 [1] NCCL INFO NVLS multicast support is not available on dev 1
b-33-25:6462:6586 [0] NCCL INFO comm 0x55da8c205640 rank 0 nRanks 4 nNodes 1 localRanks 4 localRank 0 MNNVL 0
b-33-25:6463:6588 [1] NCCL INFO comm 0x557c9fac8540 rank 1 nRanks 4 nNodes 1 localRanks 4 localRank 1 MNNVL 0
b-33-25:6464:6589 [2] NCCL INFO comm 0x56382c525e80 rank 2 nRanks 4 nNodes 1 localRanks 4 localRank 2 MNNVL 0
b-33-25:6465:6587 [3] NCCL INFO comm 0x5580c708c780 rank 3 nRanks 4 nNodes 1 localRanks 4 localRank 3 MNNVL 0
b-33-25:6462:6586 [0] NCCL INFO Channel 00/02 :    0   1   2   3
b-33-25:6463:6588 [1] NCCL INFO Trees [0] 2/-1/-1->1->0 [1] 2/-1/-1->1->0
b-33-25:6462:6586 [0] NCCL INFO Channel 01/02 :    0   1   2   3
b-33-25:6464:6589 [2] NCCL INFO Trees [0] 3/-1/-1->2->1 [1] 3/-1/-1->2->1
b-33-25:6463:6588 [1] NCCL INFO P2P Chunksize set to 131072
b-33-25:6465:6587 [3] NCCL INFO Trees [0] -1/-1/-1->3->2 [1] -1/-1/-1->3->2
b-33-25:6462:6586 [0] NCCL INFO Trees [0] 1/-1/-1->0->-1 [1] 1/-1/-1->0->-1
b-33-25:6464:6589 [2] NCCL INFO P2P Chunksize set to 131072
b-33-25:6465:6587 [3] NCCL INFO P2P Chunksize set to 131072
b-33-25:6462:6586 [0] NCCL INFO P2P Chunksize set to 131072
b-33-25:6464:6589 [2] NCCL INFO Channel 00 : 2[2] -> 3[3] via SHM/direct/direct
b-33-25:6462:6586 [0] NCCL INFO Channel 00 : 0[0] -> 1[1] via SHM/direct/direct
b-33-25:6463:6588 [1] NCCL INFO Channel 00 : 1[1] -> 2[2] via SHM/direct/direct
b-33-25:6464:6589 [2] NCCL INFO Channel 01 : 2[2] -> 3[3] via SHM/direct/direct
b-33-25:6462:6586 [0] NCCL INFO Channel 01 : 0[0] -> 1[1] via SHM/direct/direct
b-33-25:6465:6587 [3] NCCL INFO Channel 00 : 3[3] -> 0[0] via SHM/direct/direct
b-33-25:6463:6588 [1] NCCL INFO Channel 01 : 1[1] -> 2[2] via SHM/direct/direct
b-33-25:6465:6587 [3] NCCL INFO Channel 01 : 3[3] -> 0[0] via SHM/direct/direct
b-33-25:6463:6588 [1] NCCL INFO Connected all rings
b-33-25:6464:6589 [2] NCCL INFO Connected all rings
b-33-25:6465:6587 [3] NCCL INFO Connected all rings
b-33-25:6462:6586 [0] NCCL INFO Connected all rings
b-33-25:6465:6587 [3] NCCL INFO Channel 00 : 3[3] -> 2[2] via SHM/direct/direct
b-33-25:6465:6587 [3] NCCL INFO Channel 01 : 3[3] -> 2[2] via SHM/direct/direct
b-33-25:6464:6589 [2] NCCL INFO Channel 00 : 2[2] -> 1[1] via SHM/direct/direct
b-33-25:6463:6588 [1] NCCL INFO Channel 00 : 1[1] -> 0[0] via SHM/direct/direct
b-33-25:6464:6589 [2] NCCL INFO Channel 01 : 2[2] -> 1[1] via SHM/direct/direct
b-33-25:6463:6588 [1] NCCL INFO Channel 01 : 1[1] -> 0[0] via SHM/direct/direct
b-33-25:6462:6586 [0] NCCL INFO Connected all trees
b-33-25:6462:6586 [0] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 512 | 512
b-33-25:6462:6586 [0] NCCL INFO 2 coll channels, 2 collnet channels, 0 nvls channels, 2 p2p channels, 2 p2p channels per peer
b-33-25:6465:6587 [3] NCCL INFO Connected all trees
b-33-25:6465:6587 [3] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 512 | 512
b-33-25:6465:6587 [3] NCCL INFO 2 coll channels, 2 collnet channels, 0 nvls channels, 2 p2p channels, 2 p2p channels per peer
b-33-25:6463:6588 [1] NCCL INFO Connected all trees
b-33-25:6463:6588 [1] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 512 | 512
b-33-25:6463:6588 [1] NCCL INFO 2 coll channels, 2 collnet channels, 0 nvls channels, 2 p2p channels, 2 p2p channels per peer
b-33-25:6464:6589 [2] NCCL INFO Connected all trees
b-33-25:6464:6589 [2] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 512 | 512
b-33-25:6464:6589 [2] NCCL INFO 2 coll channels, 2 collnet channels, 0 nvls channels, 2 p2p channels, 2 p2p channels per peer
b-33-25:6464:6589 [2] NCCL INFO TUNER/Plugin: Plugin load returned 2 : libnccl-net.so: cannot open shared object file: No such file or directory : when loading libnccl-tuner.so
b-33-25:6465:6587 [3] NCCL INFO TUNER/Plugin: Plugin load returned 2 : libnccl-net.so: cannot open shared object file: No such file or directory : when loading libnccl-tuner.so
b-33-25:6462:6586 [0] NCCL INFO TUNER/Plugin: Plugin load returned 2 : libnccl-net.so: cannot open shared object file: No such file or directory : when loading libnccl-tuner.so
b-33-25:6464:6589 [2] NCCL INFO TUNER/Plugin: Using internal tuner plugin.
b-33-25:6463:6588 [1] NCCL INFO TUNER/Plugin: Plugin load returned 2 : libnccl-net.so: cannot open shared object file: No such file or directory : when loading libnccl-tuner.so
b-33-25:6465:6587 [3] NCCL INFO TUNER/Plugin: Using internal tuner plugin.
b-33-25:6462:6586 [0] NCCL INFO TUNER/Plugin: Using internal tuner plugin.
b-33-25:6464:6589 [2] NCCL INFO ncclCommInitRank comm 0x56382c525e80 rank 2 nranks 4 cudaDev 2 nvmlDev 2 busId 50 commId 0xe9a19da4e79a4a87 - Init COMPLETE
b-33-25:6463:6588 [1] NCCL INFO TUNER/Plugin: Using internal tuner plugin.
b-33-25:6465:6587 [3] NCCL INFO ncclCommInitRank comm 0x5580c708c780 rank 3 nranks 4 cudaDev 3 nvmlDev 3 busId 60 commId 0xe9a19da4e79a4a87 - Init COMPLETE
b-33-25:6462:6586 [0] NCCL INFO ncclCommInitRank comm 0x55da8c205640 rank 0 nranks 4 cudaDev 0 nvmlDev 0 busId 30 commId 0xe9a19da4e79a4a87 - Init COMPLETE
b-33-25:6463:6588 [1] NCCL INFO ncclCommInitRank comm 0x557c9fac8540 rank 1 nranks 4 cudaDev 1 nvmlDev 1 busId 40 commId 0xe9a19da4e79a4a87 - Init COMPLETE
wandb: Using wandb-core as the SDK backend.  Please refer to https://wandb.me/wandb-core for more information.
wandb: Using wandb-core as the SDK backend.  Please refer to https://wandb.me/wandb-core for more information.
wandb: Currently logged in as: ziyil0323. Use `wandb login --relogin` to force relogin
wandb: Currently logged in as: ziyil0323. Use `wandb login --relogin` to force relogin
wandb: Using wandb-core as the SDK backend.  Please refer to https://wandb.me/wandb-core for more information.
wandb: Currently logged in as: ziyil0323. Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.18.7
wandb: Run data is saved locally in /scratch/zl5604/project/wandb/run-20241208_084239-70rdgx6j
wandb: Run `wandb offline` to turn off syncing.
wandb: Tracking run with wandb version 0.18.7
wandb: Run data is saved locally in /scratch/zl5604/project/wandb/run-20241208_084240-zgo9lj6m
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run lucky-shadow-6
wandb: ⭐️ View project at https://wandb.ai/ziyil0323/gpt2-benchmark%20ddp
wandb: 🚀 View run at https://wandb.ai/ziyil0323/gpt2-benchmark%20ddp/runs/70rdgx6j
wandb: Syncing run stoic-cloud-6
wandb: ⭐️ View project at https://wandb.ai/ziyil0323/gpt2-benchmark%20ddp
wandb: 🚀 View run at https://wandb.ai/ziyil0323/gpt2-benchmark%20ddp/runs/zgo9lj6m
Profiler ranks: [0], local rank: 3Profiler ranks: [0], local rank: 1

Training:   0%|                                                                                                                                                               | 0/31 [00:00<?, ?it/s]Training:   0%|                                                                                                                                                               | 0/31 [00:00<?, ?it/s]wandb: Tracking run with wandb version 0.18.7
wandb: Run data is saved locally in /scratch/zl5604/project/wandb/run-20241208_084240-v095hv6b
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run glowing-dust-8
wandb: ⭐️ View project at https://wandb.ai/ziyil0323/gpt2-benchmark%20ddp
wandb: 🚀 View run at https://wandb.ai/ziyil0323/gpt2-benchmark%20ddp/runs/v095hv6b
Profiler ranks: [0], local rank: 2
Training:   0%|                                                                                                                                                               | 0/31 [00:00<?, ?it/s]wandb: Using wandb-core as the SDK backend.  Please refer to https://wandb.me/wandb-core for more information.
wandb: Currently logged in as: ziyil0323. Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.18.7
wandb: Run data is saved locally in /scratch/zl5604/project/wandb/run-20241208_084242-gkzb7hg4
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run silvery-snow-9
wandb: ⭐️ View project at https://wandb.ai/ziyil0323/gpt2-benchmark%20ddp
wandb: 🚀 View run at https://wandb.ai/ziyil0323/gpt2-benchmark%20ddp/runs/gkzb7hg4
Profiler ranks: [0], local rank: 0
local rank: 0 profiler initialized
check profiler if it is running: None on rank 0
Training:   0%|                                                                                                                                                               | 0/31 [00:00<?, ?it/s]Training:   3%|████▊                                                                                                                                                  | 1/31 [00:07<03:35,  7.17s/it]Training:   3%|████▊                                                                                                                                                  | 1/31 [00:07<03:35,  7.17s/it]Training:   3%|████▊                                                                                                                                                  | 1/31 [00:07<03:31,  7.05s/it]Training:   3%|████▊                                                                                                                                                  | 1/31 [00:04<02:22,  4.76s/it]Training:   6%|█████████▋                                                                                                                                             | 2/31 [00:07<01:29,  3.08s/it]Training:   6%|█████████▋                                                                                                                                             | 2/31 [00:07<01:29,  3.08s/it]Training:   6%|█████████▋                                                                                                                                             | 2/31 [00:04<01:00,  2.09s/it]Training:   6%|█████████▋                                                                                                                                             | 2/31 [00:07<01:28,  3.04s/it]/ext3/miniforge3/envs/deepspeed/lib/python3.12/site-packages/torch/optim/lr_scheduler.py:240: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
/ext3/miniforge3/envs/deepspeed/lib/python3.12/site-packages/torch/optim/lr_scheduler.py:240: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
/ext3/miniforge3/envs/deepspeed/lib/python3.12/site-packages/torch/optim/lr_scheduler.py:240: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
/ext3/miniforge3/envs/deepspeed/lib/python3.12/site-packages/torch/optim/lr_scheduler.py:240: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
Training:  10%|██████████████▌                                                                                                                                        | 3/31 [00:08<01:02,  2.22s/it]Training:  10%|██████████████▌                                                                                                                                        | 3/31 [00:08<01:01,  2.19s/it]Training:  10%|██████████████▌                                                                                                                                        | 3/31 [00:08<01:02,  2.22s/it]Training:  10%|██████████████▌                                                                                                                                        | 3/31 [00:06<00:47,  1.68s/it]Training:  13%|███████████████████▍                                                                                                                                   | 4/31 [00:07<00:39,  1.48s/it]Training:  13%|███████████████████▍                                                                                                                                   | 4/31 [00:09<00:48,  1.81s/it]Training:  13%|███████████████████▍                                                                                                                                   | 4/31 [00:09<00:48,  1.79s/it]Training:  13%|███████████████████▍                                                                                                                                   | 4/31 [00:09<00:48,  1.81s/it]Training:  16%|████████████████████████▎                                                                                                                              | 5/31 [00:10<00:41,  1.58s/it]Training:  16%|████████████████████████▎                                                                                                                              | 5/31 [00:10<00:41,  1.58s/it]Training:  16%|████████████████████████▎                                                                                                                              | 5/31 [00:10<00:40,  1.57s/it]Training:  16%|████████████████████████▎                                                                                                                              | 5/31 [00:09<00:44,  1.73s/it]Training:  19%|█████████████████████████████▏                                                                                                                         | 6/31 [00:12<00:38,  1.55s/it]Training:  19%|█████████████████████████████▏                                                                                                                         | 6/31 [00:12<00:38,  1.55s/it]Training:  19%|█████████████████████████████▏                                                                                                                         | 6/31 [00:12<00:39,  1.58s/it]Training:  19%|█████████████████████████████▏                                                                                                                         | 6/31 [00:10<00:33,  1.36s/it]Training:  23%|██████████████████████████████████                                                                                                                     | 7/31 [00:13<00:33,  1.40s/it]Training:  23%|██████████████████████████████████                                                                                                                     | 7/31 [00:13<00:33,  1.40s/it]Training:  23%|██████████████████████████████████                                                                                                                     | 7/31 [00:11<00:29,  1.23s/it]Training:  23%|██████████████████████████████████                                                                                                                     | 7/31 [00:13<00:33,  1.39s/it]Training:  26%|██████████████████████████████████████▉                                                                                                                | 8/31 [00:12<00:27,  1.22s/it]Training:  26%|██████████████████████████████████████▉                                                                                                                | 8/31 [00:14<00:30,  1.34s/it]Training:  26%|██████████████████████████████████████▉                                                                                                                | 8/31 [00:14<00:30,  1.32s/it]Training:  26%|██████████████████████████████████████▉                                                                                                                | 8/31 [00:14<00:30,  1.34s/it]Training:  29%|███████████████████████████████████████████▊                                                                                                           | 9/31 [00:15<00:28,  1.29s/it]Training:  29%|███████████████████████████████████████████▊                                                                                                           | 9/31 [00:15<00:28,  1.28s/it]Training:  29%|███████████████████████████████████████████▊                                                                                                           | 9/31 [00:13<00:26,  1.21s/it]Training:  29%|███████████████████████████████████████████▊                                                                                                           | 9/31 [00:15<00:28,  1.29s/it]Training:  32%|████████████████████████████████████████████████▍                                                                                                     | 10/31 [00:17<00:26,  1.26s/it]Training:  32%|████████████████████████████████████████████████▍                                                                                                     | 10/31 [00:14<00:25,  1.20s/it]Training:  32%|████████████████████████████████████████████████▍                                                                                                     | 10/31 [00:17<00:26,  1.26s/it]Training:  32%|████████████████████████████████████████████████▍                                                                                                     | 10/31 [00:16<00:26,  1.25s/it]Training:  35%|█████████████████████████████████████████████████████▏                                                                                                | 11/31 [00:18<00:26,  1.32s/it]Training:  35%|█████████████████████████████████████████████████████▏                                                                                                | 11/31 [00:18<00:26,  1.31s/it]Training:  35%|█████████████████████████████████████████████████████▏                                                                                                | 11/31 [00:18<00:26,  1.32s/it]Training:  35%|█████████████████████████████████████████████████████▏                                                                                                | 11/31 [00:16<00:26,  1.32s/it]Training:  39%|██████████████████████████████████████████████████████████                                                                                            | 12/31 [00:19<00:23,  1.22s/it]Training:  39%|██████████████████████████████████████████████████████████                                                                                            | 12/31 [00:17<00:22,  1.19s/it]Training:  39%|██████████████████████████████████████████████████████████                                                                                            | 12/31 [00:19<00:23,  1.23s/it]Training:  39%|██████████████████████████████████████████████████████████                                                                                            | 12/31 [00:19<00:23,  1.23s/it]Training:  42%|██████████████████████████████████████████████████████████████▉                                                                                       | 13/31 [00:20<00:21,  1.22s/it]Training:  42%|██████████████████████████████████████████████████████████████▉                                                                                       | 13/31 [00:18<00:21,  1.19s/it]Training:  42%|██████████████████████████████████████████████████████████████▉                                                                                       | 13/31 [00:20<00:21,  1.22s/it]Training:  42%|██████████████████████████████████████████████████████████████▉                                                                                       | 13/31 [00:20<00:21,  1.22s/it]Training:  45%|███████████████████████████████████████████████████████████████████▋                                                                                  | 14/31 [00:19<00:20,  1.19s/it]Training:  45%|███████████████████████████████████████████████████████████████████▋                                                                                  | 14/31 [00:21<00:20,  1.22s/it]Training:  45%|███████████████████████████████████████████████████████████████████▋                                                                                  | 14/31 [00:21<00:20,  1.21s/it]Training:  45%|███████████████████████████████████████████████████████████████████▋                                                                                  | 14/31 [00:21<00:20,  1.21s/it]Training:  48%|████████████████████████████████████████████████████████████████████████▌                                                                             | 15/31 [00:23<00:19,  1.21s/it]Training:  48%|████████████████████████████████████████████████████████████████████████▌                                                                             | 15/31 [00:20<00:19,  1.20s/it]Training:  48%|████████████████████████████████████████████████████████████████████████▌                                                                             | 15/31 [00:23<00:19,  1.21s/it]Training:  48%|████████████████████████████████████████████████████████████████████████▌                                                                             | 15/31 [00:23<00:19,  1.21s/it]Step 15: loss 2.538282871246338Step 15: loss 2.538282871246338Step 15: loss 2.538282871246338Step 15: loss 2.538282871246338



Learning rate: 8.339733570774807e-05
Learning rate: 8.339733570774807e-05Learning rate: 8.339733570774807e-05Learning rate: 8.339733570774807e-05


elapsed_time_per_iteration: 1.5393407503763834 s
elapsed_time_per_iteration: 1.5393403053283692 selapsed_time_per_iteration: 1.5393438657124838 sThroughput (TFLOPS) at step 15: 4.547114971840083


Throughput (TFLOPS) at step 15: 4.547116286484077elapsed_time_per_iteration: 1.5393408139546711 sThroughput (TFLOPS) at step 15: 4.5471057693534


Throughput (TFLOPS) at step 15: 4.54711478403386
Torch reports memory usage: 2406.732421875 MBTorch reports memory usage: 2406.732421875 MB
Torch reports memory usage: 2406.732421875 MB

Torch reports memory usage: 2406.732421875 MB
GPUtil reports memory usage: 
+----+-----------+----------+------------------+------------------+-------------------+------------------+
| ID |   Name    | Load (%) | Free Memory (MB) | Used Memory (MB) | Total Memory (MB) | Temperature (°C) |
+----+-----------+----------+------------------+------------------+-------------------+------------------+
| 0  | NVIDIA L4 |  100.0%  |      3656.0      |     18939.0      |      23034.0      |      78.0°C      |
| 1  | NVIDIA L4 |  100.0%  |      3668.0      |     18927.0      |      23034.0      |      74.0°C      |
| 2  | NVIDIA L4 |  100.0%  |      3668.0      |     18927.0      |      23034.0      |      70.0°C      |
| 3  | NVIDIA L4 |  100.0%  |      3668.0      |     18927.0      |      23034.0      |      72.0°C      |
+----+-----------+----------+------------------+------------------+-------------------+------------------+
GPUtil reports memory usage: 
+----+-----------+----------+------------------+------------------+-------------------+------------------+
| ID |   Name    | Load (%) | Free Memory (MB) | Used Memory (MB) | Total Memory (MB) | Temperature (°C) |
+----+-----------+----------+------------------+------------------+-------------------+------------------+
| 0  | NVIDIA L4 |  100.0%  |      3656.0      |     18939.0      |      23034.0      |      78.0°C      |
| 1  | NVIDIA L4 |  100.0%  |      3668.0      |     18927.0      |      23034.0      |      74.0°C      |
| 2  | NVIDIA L4 |  100.0%  |      3668.0      |     18927.0      |      23034.0      |      70.0°C      |
| 3  | NVIDIA L4 |  100.0%  |      3668.0      |     18927.0      |      23034.0      |      71.0°C      |
+----+-----------+----------+------------------+------------------+-------------------+------------------+
GPUtil reports memory usage: 
+----+-----------+----------+------------------+------------------+-------------------+------------------+
| ID |   Name    | Load (%) | Free Memory (MB) | Used Memory (MB) | Total Memory (MB) | Temperature (°C) |
+----+-----------+----------+------------------+------------------+-------------------+------------------+
| 0  | NVIDIA L4 |  100.0%  |      3656.0      |     18939.0      |      23034.0      |      78.0°C      |
| 1  | NVIDIA L4 |  100.0%  |      3668.0      |     18927.0      |      23034.0      |      74.0°C      |
| 2  | NVIDIA L4 |  100.0%  |      3668.0      |     18927.0      |      23034.0      |      70.0°C      |
| 3  | NVIDIA L4 |  100.0%  |      3668.0      |     18927.0      |      23034.0      |      71.0°C      |
+----+-----------+----------+------------------+------------------+-------------------+------------------+
GPUtil reports memory usage: 
+----+-----------+----------+------------------+------------------+-------------------+------------------+
| ID |   Name    | Load (%) | Free Memory (MB) | Used Memory (MB) | Total Memory (MB) | Temperature (°C) |
+----+-----------+----------+------------------+------------------+-------------------+------------------+
| 0  | NVIDIA L4 |  100.0%  |      3656.0      |     18939.0      |      23034.0      |      78.0°C      |
| 1  | NVIDIA L4 |  100.0%  |      3668.0      |     18927.0      |      23034.0      |      74.0°C      |
| 2  | NVIDIA L4 |  100.0%  |      3668.0      |     18927.0      |      23034.0      |      70.0°C      |
| 3  | NVIDIA L4 |  100.0%  |      3668.0      |     18927.0      |      23034.0      |      71.0°C      |
+----+-----------+----------+------------------+------------------+-------------------+------------------+




Validation:   0%|                                                                                                                                                             | 0/10 [00:00<?, ?it/s]Validation:   0%|                                                                                                                                                             | 0/10 [00:00<?, ?it/s]Validation:   0%|                                                                                                                                                             | 0/10 [00:00<?, ?it/s]Validation:   0%|                                                                                                                                                             | 0/10 [00:00<?, ?it/s][A[A[A[A
Validation:  10%|██████████████▉                                                                                                                                      | 1/10 [00:00<00:04,  2.25it/s][A
Validation:  10%|██████████████▉                                                                                                                                      | 1/10 [00:00<00:04,  2.21it/s][A

Validation:  10%|██████████████▉                                                                                                                                      | 1/10 [00:00<00:04,  2.20it/s]Validation:  10%|██████████████▉                                                                                                                                      | 1/10 [00:00<00:04,  2.20it/s][A[A
Validation:  20%|█████████████████████████████▊                                                                                                                       | 2/10 [00:00<00:03,  2.52it/s][A
Validation:  20%|█████████████████████████████▊                                                                                                                       | 2/10 [00:00<00:03,  2.48it/s][A
Validation:  20%|█████████████████████████████▊                                                                                                                       | 2/10 [00:00<00:03,  2.44it/s][A
Validation:  20%|█████████████████████████████▊                                                                                                                       | 2/10 [00:00<00:03,  2.43it/s][A
Validation:  30%|████████████████████████████████████████████▋                                                                                                        | 3/10 [00:01<00:02,  2.59it/s][A
Validation:  30%|████████████████████████████████████████████▋                                                                                                        | 3/10 [00:01<00:02,  2.53it/s][A
Validation:  30%|████████████████████████████████████████████▋                                                                                                        | 3/10 [00:01<00:02,  2.49it/s][A
Validation:  30%|████████████████████████████████████████████▋                                                                                                        | 3/10 [00:01<00:02,  2.45it/s][A
Validation:  40%|███████████████████████████████████████████████████████████▌                                                                                         | 4/10 [00:01<00:02,  2.62it/s][A
Validation:  40%|███████████████████████████████████████████████████████████▌                                                                                         | 4/10 [00:01<00:02,  2.57it/s][A
Validation:  40%|███████████████████████████████████████████████████████████▌                                                                                         | 4/10 [00:01<00:02,  2.55it/s][A
Validation:  40%|███████████████████████████████████████████████████████████▌                                                                                         | 4/10 [00:01<00:02,  2.50it/s][A
Validation:  50%|██████████████████████████████████████████████████████████████████████████▌                                                                          | 5/10 [00:01<00:01,  2.63it/s][A
Validation:  50%|██████████████████████████████████████████████████████████████████████████▌                                                                          | 5/10 [00:01<00:01,  2.60it/s][A
Validation:  50%|██████████████████████████████████████████████████████████████████████████▌                                                                          | 5/10 [00:01<00:01,  2.57it/s][A
Validation:  50%|██████████████████████████████████████████████████████████████████████████▌                                                                          | 5/10 [00:02<00:01,  2.52it/s][A
Validation:  60%|█████████████████████████████████████████████████████████████████████████████████████████▍                                                           | 6/10 [00:02<00:01,  2.64it/s][A
Validation:  60%|█████████████████████████████████████████████████████████████████████████████████████████▍                                                           | 6/10 [00:02<00:01,  2.60it/s][A
Validation:  60%|█████████████████████████████████████████████████████████████████████████████████████████▍                                                           | 6/10 [00:02<00:01,  2.57it/s][A
Validation:  60%|█████████████████████████████████████████████████████████████████████████████████████████▍                                                           | 6/10 [00:02<00:01,  2.53it/s][A
Validation:  70%|████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                            | 7/10 [00:02<00:01,  2.67it/s][A
Validation:  70%|████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                            | 7/10 [00:02<00:01,  2.60it/s][A
Validation:  70%|████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                            | 7/10 [00:02<00:01,  2.57it/s][A
Validation:  70%|████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                            | 7/10 [00:02<00:01,  2.54it/s][A
Validation:  80%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                             | 8/10 [00:03<00:00,  2.66it/s][A
Validation:  80%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                             | 8/10 [00:03<00:00,  2.62it/s][A
Validation:  80%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                             | 8/10 [00:03<00:00,  2.59it/s][A
Validation:  80%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                             | 8/10 [00:03<00:00,  2.55it/s][A
Validation:  90%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████               | 9/10 [00:03<00:00,  2.66it/s][A
Validation:  90%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████               | 9/10 [00:03<00:00,  2.62it/s][A
Validation:  90%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████               | 9/10 [00:03<00:00,  2.60it/s][A
Validation:  90%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████               | 9/10 [00:03<00:00,  2.55it/s][A
Validation: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:03<00:00,  2.68it/s][AValidation: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:03<00:00,  2.61it/s]

Validation: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:03<00:00,  2.61it/s][AValidation: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:03<00:00,  2.56it/s]
Validation loss: 2.295305573940277, Perplexity: 9.927469124699105

Validation: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:03<00:00,  2.60it/s][AValidation: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:03<00:00,  2.54it/s]

Validation: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:03<00:00,  2.55it/s][AValidation loss: 2.295305573940277, Perplexity: 9.927469124699105
Validation: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:04<00:00,  2.50it/s]
Validation loss: 2.295305573940277, Perplexity: 9.927469124699105
Validation loss: 2.295305573940277, Perplexity: 9.927469124699105
Checkpoint saved at ./checkpoints/checkpoint-15
Training:  52%|█████████████████████████████████████████████████████████████████████████████▍                                                                        | 16/31 [00:34<01:05,  4.36s/it]Checkpoint saved at ./checkpoints/checkpoint-15
Training:  52%|█████████████████████████████████████████████████████████████████████████████▍                                                                        | 16/31 [00:34<01:05,  4.35s/it]Checkpoint saved at ./checkpoints/checkpoint-15Checkpoint saved at ./checkpoints/checkpoint-15

Training:  52%|█████████████████████████████████████████████████████████████████████████████▍                                                                        | 16/31 [00:34<01:05,  4.36s/it]Training:  52%|█████████████████████████████████████████████████████████████████████████████▍                                                                        | 16/31 [00:32<01:05,  4.35s/it]Training:  55%|██████████████████████████████████████████████████████████████████████████████████▎                                                                   | 17/31 [00:35<00:45,  3.25s/it]Training:  55%|██████████████████████████████████████████████████████████████████████████████████▎                                                                   | 17/31 [00:35<00:45,  3.25s/it]Training:  55%|██████████████████████████████████████████████████████████████████████████████████▎                                                                   | 17/31 [00:35<00:45,  3.26s/it]Training:  55%|██████████████████████████████████████████████████████████████████████████████████▎                                                                   | 17/31 [00:33<00:45,  3.25s/it]Training:  58%|███████████████████████████████████████████████████████████████████████████████████████                                                               | 18/31 [00:36<00:32,  2.54s/it]Training:  58%|███████████████████████████████████████████████████████████████████████████████████████                                                               | 18/31 [00:36<00:32,  2.54s/it]Training:  58%|███████████████████████████████████████████████████████████████████████████████████████                                                               | 18/31 [00:33<00:32,  2.53s/it]Training:  58%|███████████████████████████████████████████████████████████████████████████████████████                                                               | 18/31 [00:36<00:32,  2.54s/it]Training:  61%|███████████████████████████████████████████████████████████████████████████████████████████▉                                                          | 19/31 [00:37<00:25,  2.14s/it]Training:  61%|███████████████████████████████████████████████████████████████████████████████████████████▉                                                          | 19/31 [00:35<00:25,  2.14s/it]Training:  61%|███████████████████████████████████████████████████████████████████████████████████████████▉                                                          | 19/31 [00:37<00:25,  2.14s/it]Training:  61%|███████████████████████████████████████████████████████████████████████████████████████████▉                                                          | 19/31 [00:37<00:25,  2.14s/it]Training:  65%|████████████████████████████████████████████████████████████████████████████████████████████████▊                                                     | 20/31 [00:38<00:20,  1.87s/it]Training:  65%|████████████████████████████████████████████████████████████████████████████████████████████████▊                                                     | 20/31 [00:38<00:20,  1.87s/it]Training:  65%|████████████████████████████████████████████████████████████████████████████████████████████████▊                                                     | 20/31 [00:38<00:20,  1.87s/it]Training:  65%|████████████████████████████████████████████████████████████████████████████████████████████████▊                                                     | 20/31 [00:40<00:33,  3.07s/it]Training:  68%|█████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                | 21/31 [00:43<00:26,  2.66s/it]Training:  68%|█████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                | 21/31 [00:43<00:26,  2.67s/it]Training:  68%|█████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                | 21/31 [00:43<00:26,  2.67s/it]Training:  68%|█████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                | 21/31 [00:40<00:23,  2.31s/it]Training:  71%|██████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                           | 22/31 [00:42<00:17,  1.93s/it]Training:  71%|██████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                           | 22/31 [00:44<00:19,  2.19s/it]Training:  71%|██████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                           | 22/31 [00:44<00:19,  2.19s/it]Training:  71%|██████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                           | 22/31 [00:44<00:19,  2.19s/it]Training:  74%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                      | 23/31 [00:43<00:13,  1.72s/it]Training:  74%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                      | 23/31 [00:45<00:15,  1.90s/it]Training:  74%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                      | 23/31 [00:45<00:15,  1.90s/it]Training:  74%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                      | 23/31 [00:45<00:15,  1.90s/it]Training:  77%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                 | 24/31 [00:44<00:11,  1.58s/it]Training:  77%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                 | 24/31 [00:46<00:11,  1.70s/it]Training:  77%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                 | 24/31 [00:46<00:11,  1.70s/it]Training:  77%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                 | 24/31 [00:46<00:11,  1.70s/it]Training:  81%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                             | 25/31 [00:45<00:08,  1.48s/it]Training:  81%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                             | 25/31 [00:48<00:09,  1.57s/it]Training:  81%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                             | 25/31 [00:48<00:09,  1.56s/it]Training:  81%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                             | 25/31 [00:48<00:09,  1.56s/it]Training:  84%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                        | 26/31 [00:49<00:07,  1.55s/it]Training:  84%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                        | 26/31 [00:47<00:07,  1.49s/it]Training:  84%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                        | 26/31 [00:49<00:07,  1.57s/it]Training:  84%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                        | 26/31 [00:49<00:07,  1.57s/it]Training:  87%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                   | 27/31 [00:48<00:05,  1.38s/it]Training:  87%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                   | 27/31 [00:50<00:05,  1.42s/it]Training:  87%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                   | 27/31 [00:50<00:05,  1.42s/it]Training:  87%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                   | 27/31 [00:50<00:05,  1.42s/it]Training:  90%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍              | 28/31 [00:52<00:04,  1.37s/it]Training:  90%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍              | 28/31 [00:52<00:04,  1.37s/it]Training:  90%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍              | 28/31 [00:49<00:04,  1.34s/it]Training:  90%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍              | 28/31 [00:51<00:04,  1.37s/it]Training:  94%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎         | 29/31 [00:50<00:02,  1.31s/it]Training:  94%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎         | 29/31 [00:53<00:02,  1.33s/it]Training:  94%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎         | 29/31 [00:53<00:02,  1.33s/it]Training:  94%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎         | 29/31 [00:53<00:02,  1.33s/it]Training:  97%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏    | 30/31 [00:54<00:01,  1.31s/it]Training:  97%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏    | 30/31 [00:52<00:01,  1.29s/it]Training:  97%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏    | 30/31 [00:54<00:01,  1.31s/it]Training:  97%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏    | 30/31 [00:54<00:01,  1.31s/it]Step 30: loss 2.3204550743103027Step 30: loss 2.3204550743103027Step 30: loss 2.3204550743103027Step 30: loss 2.3204550743103027



Learning rate: 0.0
Learning rate: 0.0Learning rate: 0.0
Learning rate: 0.0

elapsed_time_per_iteration: 0.9073401848475139 selapsed_time_per_iteration: 0.907338269551595 s

Throughput (TFLOPS) at step 30: 7.7143879054712095elapsed_time_per_iteration: 0.9073394298553467 s
Throughput (TFLOPS) at step 30: 7.714371621241854

Throughput (TFLOPS) at step 30: 7.714378040328205
elapsed_time_per_iteration: 0.9073396603266398 s
Throughput (TFLOPS) at step 30: 7.7143760808165025
Torch reports memory usage: 2407.5712890625 MB
Torch reports memory usage: 2408.783203125 MBTorch reports memory usage: 2407.5205078125 MB

Torch reports memory usage: 2407.5205078125 MB
GPUtil reports memory usage: 
+----+-----------+----------+------------------+------------------+-------------------+------------------+
| ID |   Name    | Load (%) | Free Memory (MB) | Used Memory (MB) | Total Memory (MB) | Temperature (°C) |
+----+-----------+----------+------------------+------------------+-------------------+------------------+
| 0  | NVIDIA L4 |  100.0%  |      2040.0      |     20555.0      |      23034.0      |      75.0°C      |
| 1  | NVIDIA L4 |  100.0%  |      2052.0      |     20543.0      |      23034.0      |      72.0°C      |
| 2  | NVIDIA L4 |  100.0%  |      2052.0      |     20543.0      |      23034.0      |      74.0°C      |
| 3  | NVIDIA L4 |  100.0%  |      2052.0      |     20543.0      |      23034.0      |      76.0°C      |
+----+-----------+----------+------------------+------------------+-------------------+------------------+
GPUtil reports memory usage: 
+----+-----------+----------+------------------+------------------+-------------------+------------------+
| ID |   Name    | Load (%) | Free Memory (MB) | Used Memory (MB) | Total Memory (MB) | Temperature (°C) |
+----+-----------+----------+------------------+------------------+-------------------+------------------+
| 0  | NVIDIA L4 |  100.0%  |      2040.0      |     20555.0      |      23034.0      |      75.0°C      |
| 1  | NVIDIA L4 |  100.0%  |      2052.0      |     20543.0      |      23034.0      |      72.0°C      |
| 2  | NVIDIA L4 |  100.0%  |      2052.0      |     20543.0      |      23034.0      |      74.0°C      |
| 3  | NVIDIA L4 |  100.0%  |      2052.0      |     20543.0      |      23034.0      |      76.0°C      |
+----+-----------+----------+------------------+------------------+-------------------+------------------+
GPUtil reports memory usage: 
+----+-----------+----------+------------------+------------------+-------------------+------------------+
| ID |   Name    | Load (%) | Free Memory (MB) | Used Memory (MB) | Total Memory (MB) | Temperature (°C) |
+----+-----------+----------+------------------+------------------+-------------------+------------------+
| 0  | NVIDIA L4 |  100.0%  |      2040.0      |     20555.0      |      23034.0      |      75.0°C      |
| 1  | NVIDIA L4 |  100.0%  |      2052.0      |     20543.0      |      23034.0      |      72.0°C      |
| 2  | NVIDIA L4 |  100.0%  |      2052.0      |     20543.0      |      23034.0      |      74.0°C      |
| 3  | NVIDIA L4 |  100.0%  |      2052.0      |     20543.0      |      23034.0      |      76.0°C      |
+----+-----------+----------+------------------+------------------+-------------------+------------------+GPUtil reports memory usage: 
+----+-----------+----------+------------------+------------------+-------------------+------------------+
| ID |   Name    | Load (%) | Free Memory (MB) | Used Memory (MB) | Total Memory (MB) | Temperature (°C) |
+----+-----------+----------+------------------+------------------+-------------------+------------------+
| 0  | NVIDIA L4 |  100.0%  |      2040.0      |     20555.0      |      23034.0      |      75.0°C      |
| 1  | NVIDIA L4 |  100.0%  |      2052.0      |     20543.0      |      23034.0      |      72.0°C      |
| 2  | NVIDIA L4 |  100.0%  |      2052.0      |     20543.0      |      23034.0      |      74.0°C      |
| 3  | NVIDIA L4 |  100.0%  |      2052.0      |     20543.0      |      23034.0      |      76.0°C      |
+----+-----------+----------+------------------+------------------+-------------------+------------------+





Validation:   0%|                                                                                                                                                             | 0/10 [00:00<?, ?it/s]Validation:   0%|                                                                                                                                                             | 0/10 [00:00<?, ?it/s]Validation:   0%|                                                                                                                                                             | 0/10 [00:00<?, ?it/s]Validation:   0%|                                                                                                                                                             | 0/10 [00:00<?, ?it/s][A[A[A[A
Validation:  10%|██████████████▉                                                                                                                                      | 1/10 [00:00<00:03,  2.27it/s][A

Validation:  10%|██████████████▉                                                                                                                                      | 1/10 [00:00<00:04,  2.25it/s][AValidation:  10%|██████████████▉                                                                                                                                      | 1/10 [00:00<00:04,  2.25it/s][A
Validation:  10%|██████████████▉                                                                                                                                      | 1/10 [00:00<00:04,  2.19it/s][A
Validation:  20%|█████████████████████████████▊                                                                                                                       | 2/10 [00:00<00:03,  2.53it/s][A
Validation:  20%|█████████████████████████████▊                                                                                                                       | 2/10 [00:00<00:03,  2.51it/s][A
Validation:  20%|█████████████████████████████▊                                                                                                                       | 2/10 [00:00<00:03,  2.49it/s][A
Validation:  20%|█████████████████████████████▊                                                                                                                       | 2/10 [00:00<00:03,  2.39it/s][A
Validation:  30%|████████████████████████████████████████████▋                                                                                                        | 3/10 [00:01<00:02,  2.55it/s][A
Validation:  30%|████████████████████████████████████████████▋                                                                                                        | 3/10 [00:01<00:02,  2.55it/s][A
Validation:  30%|████████████████████████████████████████████▋                                                                                                        | 3/10 [00:01<00:02,  2.53it/s][A
Validation:  30%|████████████████████████████████████████████▋                                                                                                        | 3/10 [00:01<00:02,  2.41it/s][A
Validation:  40%|███████████████████████████████████████████████████████████▌                                                                                         | 4/10 [00:01<00:02,  2.59it/s][A
Validation:  40%|███████████████████████████████████████████████████████████▌                                                                                         | 4/10 [00:01<00:02,  2.58it/s][A
Validation:  40%|███████████████████████████████████████████████████████████▌                                                                                         | 4/10 [00:01<00:02,  2.57it/s][A
Validation:  40%|███████████████████████████████████████████████████████████▌                                                                                         | 4/10 [00:01<00:02,  2.45it/s][A
Validation:  50%|██████████████████████████████████████████████████████████████████████████▌                                                                          | 5/10 [00:01<00:01,  2.62it/s][A
Validation:  50%|██████████████████████████████████████████████████████████████████████████▌                                                                          | 5/10 [00:01<00:01,  2.59it/s][A
Validation:  50%|██████████████████████████████████████████████████████████████████████████▌                                                                          | 5/10 [00:01<00:01,  2.60it/s][A
Validation:  50%|██████████████████████████████████████████████████████████████████████████▌                                                                          | 5/10 [00:02<00:02,  2.46it/s][A
Validation:  60%|█████████████████████████████████████████████████████████████████████████████████████████▍                                                           | 6/10 [00:02<00:01,  2.61it/s][A
Validation:  60%|█████████████████████████████████████████████████████████████████████████████████████████▍                                                           | 6/10 [00:02<00:01,  2.60it/s][A
Validation:  60%|█████████████████████████████████████████████████████████████████████████████████████████▍                                                           | 6/10 [00:02<00:01,  2.61it/s][A
Validation:  60%|█████████████████████████████████████████████████████████████████████████████████████████▍                                                           | 6/10 [00:02<00:01,  2.47it/s][A
Validation:  70%|████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                            | 7/10 [00:02<00:01,  2.62it/s][A
Validation:  70%|████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                            | 7/10 [00:02<00:01,  2.62it/s][A
Validation:  70%|████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                            | 7/10 [00:02<00:01,  2.62it/s][A
Validation:  70%|████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                            | 7/10 [00:02<00:01,  2.48it/s][A
Validation:  80%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                             | 8/10 [00:03<00:00,  2.63it/s][A
Validation:  80%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                             | 8/10 [00:03<00:00,  2.63it/s][A
Validation:  80%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                             | 8/10 [00:03<00:00,  2.62it/s][A
Validation:  80%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                             | 8/10 [00:03<00:00,  2.49it/s][A
Validation:  90%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████               | 9/10 [00:03<00:00,  2.62it/s][A
Validation:  90%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████               | 9/10 [00:03<00:00,  2.62it/s][A
Validation:  90%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████               | 9/10 [00:03<00:00,  2.62it/s][A
Validation:  90%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████               | 9/10 [00:03<00:00,  2.49it/s][A
Validation: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:03<00:00,  2.63it/s][A
Validation: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:03<00:00,  2.63it/s][A
Validation: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:03<00:00,  2.63it/s][AValidation: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:03<00:00,  2.58it/s]
Validation: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:03<00:00,  2.57it/s]
Validation: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:03<00:00,  2.57it/s]
Validation loss: 2.283445429801941, Perplexity: 9.810423371699503
Validation loss: 2.283445429801941, Perplexity: 9.810423371699503
Validation loss: 2.283445429801941, Perplexity: 9.810423371699503

Validation: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:04<00:00,  2.49it/s][AValidation: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:04<00:00,  2.45it/s]
Validation loss: 2.283445429801941, Perplexity: 9.810423371699503
Checkpoint saved at ./checkpoints/checkpoint-30Checkpoint saved at ./checkpoints/checkpoint-30

Checkpoint saved at ./checkpoints/checkpoint-30Training: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 31/31 [01:06<00:00,  4.49s/it]Training: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 31/31 [01:06<00:00,  4.49s/it]
Training: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 31/31 [01:06<00:00,  4.49s/it]Checkpoint saved at ./checkpoints/checkpoint-30Training: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 31/31 [01:06<00:00,  2.14s/it]Training: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 31/31 [01:06<00:00,  2.14s/it]

Training: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 31/31 [01:06<00:00,  2.14s/it]

Training: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 31/31 [01:04<00:00,  4.48s/it]Validation:   0%|                                                                                                                                                             | 0/10 [00:00<?, ?it/s]Validation:   0%|                                                                                                                                                             | 0/10 [00:00<?, ?it/s]Training: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 31/31 [01:04<00:00,  2.07s/it]Validation:   0%|                                                                                                                                                             | 0/10 [00:00<?, ?it/s]
Stopping profiler on rank 0
Validation:  10%|██████████████▉                                                                                                                                      | 1/10 [00:00<00:03,  2.37it/s]Validation:  10%|██████████████▉                                                                                                                                      | 1/10 [00:00<00:03,  2.35it/s]Validation:  10%|██████████████▉                                                                                                                                      | 1/10 [00:00<00:03,  2.25it/s]Validation:  20%|█████████████████████████████▊                                                                                                                       | 2/10 [00:00<00:03,  2.59it/s]Validation:  20%|█████████████████████████████▊                                                                                                                       | 2/10 [00:00<00:03,  2.58it/s]Validation:  20%|█████████████████████████████▊                                                                                                                       | 2/10 [00:00<00:03,  2.44it/s]Validation:  30%|████████████████████████████████████████████▋                                                                                                        | 3/10 [00:01<00:02,  2.60it/s]Validation:  30%|████████████████████████████████████████████▋                                                                                                        | 3/10 [00:01<00:02,  2.58it/s]Validation:  30%|████████████████████████████████████████████▋                                                                                                        | 3/10 [00:01<00:02,  2.45it/s]Validation:  40%|███████████████████████████████████████████████████████████▌                                                                                         | 4/10 [00:01<00:02,  2.61it/s]Validation:  40%|███████████████████████████████████████████████████████████▌                                                                                         | 4/10 [00:01<00:02,  2.61it/s]Validation:  40%|███████████████████████████████████████████████████████████▌                                                                                         | 4/10 [00:01<00:02,  2.48it/s]Validation:  50%|██████████████████████████████████████████████████████████████████████████▌                                                                          | 5/10 [00:01<00:01,  2.63it/s]Validation:  50%|██████████████████████████████████████████████████████████████████████████▌                                                                          | 5/10 [00:01<00:01,  2.62it/s]Validation:  50%|██████████████████████████████████████████████████████████████████████████▌                                                                          | 5/10 [00:02<00:02,  2.49it/s]Validation:  60%|█████████████████████████████████████████████████████████████████████████████████████████▍                                                           | 6/10 [00:02<00:01,  2.62it/s]Validation:  60%|█████████████████████████████████████████████████████████████████████████████████████████▍                                                           | 6/10 [00:02<00:01,  2.62it/s]Validation:  60%|█████████████████████████████████████████████████████████████████████████████████████████▍                                                           | 6/10 [00:02<00:01,  2.49it/s]Validation:  70%|████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                            | 7/10 [00:02<00:01,  2.62it/s]Validation:  70%|████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                            | 7/10 [00:02<00:01,  2.62it/s]Validation:  70%|████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                            | 7/10 [00:02<00:01,  2.50it/s]Validation:  80%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                             | 8/10 [00:03<00:00,  2.63it/s]Validation:  80%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                             | 8/10 [00:03<00:00,  2.63it/s]Validation:  80%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                             | 8/10 [00:03<00:00,  2.51it/s]Validation:  90%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████               | 9/10 [00:03<00:00,  2.63it/s]Validation:  90%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████               | 9/10 [00:03<00:00,  2.63it/s]Validation:  90%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████               | 9/10 [00:03<00:00,  2.51it/s]Validation: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:03<00:00,  2.63it/s]Validation: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:03<00:00,  2.62it/s]Validation: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:03<00:00,  2.59it/s]Validation: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:03<00:00,  2.59it/s]

Final Validation loss: 2.283445429801941, Perplexity: 9.810423371699503
Final Validation loss: 2.283445429801941, Perplexity: 9.810423371699503
Validation: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:04<00:00,  2.50it/s]Validation: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:04<00:00,  2.47it/s]
Final Validation loss: 2.283445429801941, Perplexity: 9.810423371699503
check profiler if it is running: -------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  --------------------------------------------------------------------------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg       CPU Mem  Self CPU Mem      CUDA Mem  Self CUDA Mem    # of Calls                                                                      Input Shapes  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  --------------------------------------------------------------------------------  
                                          ProfilerStep*         0.59%     142.328ms         6.52%        1.583s        1.583s       0.000us         0.00%     492.231ms     492.231ms           0 b        -480 b           0 b     -10.99 Gb             1                                                                                []  
enumerate(DataLoader)#_MultiProcessingDataLoaderIter...         0.00%     100.465us         0.00%     100.465us     100.465us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b             1                                                                                []  
                                               aten::to         0.00%       9.882us         4.04%     981.953ms     981.953ms       0.000us         0.00%      82.688ms      82.688ms           0 b           0 b      64.00 Kb           0 b             1                                           [[8, 1024], [], [], [], [], [], [], []]  
                                         aten::_to_copy         0.00%      26.191us         4.04%     981.943ms     981.943ms       0.000us         0.00%      82.688ms      82.688ms           0 b           0 b      64.00 Kb           0 b             1                                               [[8, 1024], [], [], [], [], [], []]  
                                    aten::empty_strided         0.00%      49.451us         0.00%      49.451us      49.451us       0.000us         0.00%       0.000us       0.000us           0 b           0 b      64.00 Kb      64.00 Kb             1                                                          [[], [], [], [], [], []]  
                                            aten::copy_         0.00%      21.259us         4.04%     981.867ms     981.867ms       8.288us         0.00%      82.688ms      82.688ms           0 b           0 b           0 b           0 b             1                                                        [[8, 1024], [8, 1024], []]  
                                        cudaMemcpyAsync         0.00%      18.224us         0.00%      18.224us      18.224us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b             1                                                                                []  
                                  cudaStreamSynchronize         4.04%     981.692ms         4.04%     981.828ms     981.828ms       0.000us         0.00%      82.680ms      82.680ms           0 b           0 b           0 b           0 b             1                                                                                []  
                                        Memset (Device)         0.00%       0.000us         0.00%       0.000us       0.000us       1.312us         0.00%       1.312us       1.312us           0 b           0 b           0 b           0 b             1                                                                                []  
                                 ampere_sgemm_128x64_nn         0.00%       0.000us         0.00%       0.000us       0.000us     850.530us         0.00%     850.530us     850.530us           0 b           0 b           0 b           0 b             1                                                                                []  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     228.545us         0.00%     228.545us     228.545us           0 b           0 b           0 b           0 b             1                                                                                []  
void at::native::(anonymous namespace)::vectorized_l...         0.00%       0.000us         0.00%       0.000us       0.000us     106.688us         0.00%     106.688us     106.688us           0 b           0 b           0 b           0 b             1                                                                                []  
void cutlass::Kernel<cutlass_80_simt_sgemm_256x128_8...         0.00%       0.000us         0.00%       0.000us       0.000us       3.149ms         0.01%       3.149ms       3.149ms           0 b           0 b           0 b           0 b             1                                                                                []  
                               cudaPointerGetAttributes         0.00%       6.130us         0.00%       6.130us       6.130us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b             1                                                                                []  
                               cudaPointerGetAttributes         0.00%       1.191us         0.00%       1.191us       1.191us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b             1                                                                                []  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     812.354us         0.00%     812.354us     812.354us           0 b           0 b           0 b           0 b             1                                                                                []  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     868.961us         0.00%     868.961us     868.961us           0 b           0 b           0 b           0 b             1                                                                                []  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     852.609us         0.00%     852.609us     852.609us           0 b           0 b           0 b           0 b             1                                                                                []  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       1.328ms         0.01%       1.328ms       1.328ms           0 b           0 b           0 b           0 b             1                                                                                []  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     849.377us         0.00%     849.377us     849.377us           0 b           0 b           0 b           0 b             1                                                                                []  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     853.889us         0.00%     853.889us     853.889us           0 b           0 b           0 b           0 b             1                                                                                []  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     857.441us         0.00%     857.441us     857.441us           0 b           0 b           0 b           0 b             1                                                                                []  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       1.317ms         0.01%       1.317ms       1.317ms           0 b           0 b           0 b           0 b             1                                                                                []  
void cutlass::Kernel<cutlass_80_simt_sgemm_128x64_8x...         0.00%       0.000us         0.00%       0.000us       0.000us       3.351ms         0.02%       3.351ms       3.351ms           0 b           0 b           0 b           0 b             1                                                                                []  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     257.728us         0.00%     257.728us     257.728us           0 b           0 b           0 b           0 b             1                                                                                []  
void at::native::(anonymous namespace)::vectorized_l...         0.00%       0.000us         0.00%       0.000us       0.000us     121.280us         0.00%     121.280us     121.280us           0 b           0 b           0 b           0 b             1                                                                                []  
void cutlass::Kernel<cutlass_80_simt_sgemm_256x128_8...         0.00%       0.000us         0.00%       0.000us       0.000us       2.263ms         0.01%       2.263ms       2.263ms           0 b           0 b           0 b           0 b             1                                                                                []  
fmha_cutlassF_f32_aligned_64x64_rf_sm80(PyTorchMemEf...         0.00%       0.000us         0.00%       0.000us       0.000us       2.285ms         0.01%       2.285ms       2.285ms           0 b           0 b           0 b           0 b             1                                                                                []  
                                        Memset (Device)         0.00%       0.000us         0.00%       0.000us       0.000us       1.312us         0.00%       1.312us       1.312us           0 b           0 b           0 b           0 b             1                                                                                []  
                                 ampere_sgemm_128x64_nn         0.00%       0.000us         0.00%       0.000us       0.000us     841.505us         0.00%     841.505us     841.505us           0 b           0 b           0 b           0 b             1                                                                                []  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     239.232us         0.00%     239.232us     239.232us           0 b           0 b           0 b           0 b             1                                                                                []  
void at::native::(anonymous namespace)::vectorized_l...         0.00%       0.000us         0.00%       0.000us       0.000us     119.680us         0.00%     119.680us     119.680us           0 b           0 b           0 b           0 b             1                                                                                []  
void cutlass::Kernel<cutlass_80_simt_sgemm_256x128_8...         0.00%       0.000us         0.00%       0.000us       0.000us       3.131ms         0.01%       3.131ms       3.131ms           0 b           0 b           0 b           0 b             1                                                                                []  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     812.321us         0.00%     812.321us     812.321us           0 b           0 b           0 b           0 b             1                                                                                []  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     858.241us         0.00%     858.241us     858.241us           0 b           0 b           0 b           0 b             1                                                                                []  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     857.537us         0.00%     857.537us     857.537us           0 b           0 b           0 b           0 b             1                                                                                []  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       1.301ms         0.01%       1.301ms       1.301ms           0 b           0 b           0 b           0 b             1                                                                                []  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     845.442us         0.00%     845.442us     845.442us           0 b           0 b           0 b           0 b             1                                                                                []  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     869.025us         0.00%     869.025us     869.025us           0 b           0 b           0 b           0 b             1                                                                                []  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     869.217us         0.00%     869.217us     869.217us           0 b           0 b           0 b           0 b             1                                                                                []  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       1.308ms         0.01%       1.308ms       1.308ms           0 b           0 b           0 b           0 b             1                                                                                []  
                                         cudaEventQuery         0.00%       5.465us         0.00%       5.465us       5.465us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b             1                                                                                []  
                                         cudaEventQuery         0.00%       0.988us         0.00%       0.988us       0.988us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b             1                                                                                []  
                                         cudaEventQuery         0.00%       0.750us         0.00%       0.750us       0.750us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b             1                                                                                []  
                                         cudaEventQuery         0.00%       0.699us         0.00%       0.699us       0.699us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b             1                                                                                []  
                                         cudaEventQuery         0.00%       0.747us         0.00%       0.747us       0.747us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b             1                                                                                []  
                                         cudaEventQuery         0.00%       0.676us         0.00%       0.676us       0.676us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b             1                                                                                []  
                                         cudaEventQuery         0.00%       0.716us         0.00%       0.716us       0.716us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b             1                                                                                []  
                                         cudaEventQuery         0.00%       0.776us         0.00%       0.776us       0.776us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b             1                                                                                []  
                                         cudaEventQuery         0.00%       0.627us         0.00%       0.627us       0.627us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b             1                                                                                []  
                                         cudaEventQuery         0.00%       0.702us         0.00%       0.702us       0.702us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b             1                                                                                []  
                                         cudaEventQuery         0.00%       0.808us         0.00%       0.808us       0.808us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b             1                                                                                []  
                                         cudaEventQuery         0.00%       0.688us         0.00%       0.688us       0.688us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b             1                                                                                []  
                                         cudaEventQuery         0.00%       0.659us         0.00%       0.659us       0.659us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b             1                                                                                []  
void cutlass::Kernel<cutlass_80_simt_sgemm_128x64_8x...         0.00%       0.000us         0.00%       0.000us       0.000us       3.306ms         0.02%       3.306ms       3.306ms           0 b           0 b           0 b           0 b             1                                                                                []  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     259.201us         0.00%     259.201us     259.201us           0 b           0 b           0 b           0 b             1                                                                                []  
void at::native::(anonymous namespace)::vectorized_l...         0.00%       0.000us         0.00%       0.000us       0.000us     115.200us         0.00%     115.200us     115.200us           0 b           0 b           0 b           0 b             1                                                                                []  
                                ampere_sgemm_128x128_tn         0.00%       0.000us         0.00%       0.000us       0.000us      85.232ms         0.39%      85.232ms      85.232ms           0 b           0 b           0 b           0 b             1                                                                                []  
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      14.428ms         0.07%      14.428ms      14.428ms           0 b           0 b           0 b           0 b             1                                                                                []  
                                         cudaEventQuery         0.00%       4.206us         0.00%       4.206us       4.206us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b             1                                                                                []  
                                         cudaEventQuery         0.00%       0.805us         0.00%       0.805us       0.805us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b             1                                                                                []  
                                         cudaEventQuery         0.00%       0.759us         0.00%       0.759us       0.759us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b             1                                                                                []  
                                         cudaEventQuery         0.00%       0.654us         0.00%       0.654us       0.654us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b             1                                                                                []  
                                         cudaEventQuery         0.00%       0.690us         0.00%       0.690us       0.690us     339.712us         0.00%     339.712us     339.712us           0 b           0 b           0 b           0 b             1                                                                                []  
                                         cudaEventQuery         0.00%       0.703us         0.00%       0.703us       0.703us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b             1                                                                                []  
                                         cudaEventQuery         0.00%       0.662us         0.00%       0.662us       0.662us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b             1                                                                                []  
                                         cudaEventQuery         0.00%       0.663us         0.00%       0.663us       0.663us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b             1                                                                                []  
                                         cudaEventQuery         0.00%       0.588us         0.00%       0.588us       0.588us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b             1                                                                                []  
                                         cudaEventQuery         0.00%       0.635us         0.00%       0.635us       0.635us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b             1                                                                                []  
                                         cudaEventQuery         0.00%       0.607us         0.00%       0.607us       0.607us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b             1                                                                                []  
                                         cudaEventQuery         0.00%       0.618us         0.00%       0.618us       0.618us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b             1                                                                                []  
                                         cudaEventQuery         0.00%       0.651us         0.00%       0.651us       0.651us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b             1                                                                                []  
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       6.944us         0.00%       6.944us       6.944us           0 b           0 b           0 b           0 b             1                                                                                []  
void at::native::(anonymous namespace)::cunn_SoftMax...         0.00%       0.000us         0.00%       0.000us       0.000us      14.197ms         0.07%      14.197ms      14.197ms           0 b           0 b           0 b           0 b             1                                                                                []  
void at::native::(anonymous namespace)::nll_loss_for...         0.00%       0.000us         0.00%       0.000us       0.000us     340.480us         0.00%     340.480us     340.480us           0 b           0 b           0 b           0 b             1                                                                                []  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       2.560us         0.00%       2.560us       2.560us           0 b           0 b           0 b           0 b             1                                                                                []  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       6.340ms         0.03%       6.340ms       6.340ms           0 b           0 b           0 b           0 b             1                                                                                []  
void at::native::(anonymous namespace)::nll_loss_bac...         0.00%       0.000us         0.00%       0.000us       0.000us     206.752us         0.00%     206.752us     206.752us           0 b           0 b           0 b           0 b             1                                                                                []  
void at::native::(anonymous namespace)::cunn_SoftMax...         0.00%       0.000us         0.00%       0.000us       0.000us      23.573ms         0.11%      23.573ms      23.573ms           0 b           0 b           0 b           0 b             1                                                                                []  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       6.280ms         0.03%       6.280ms       6.280ms           0 b           0 b           0 b           0 b             1                                                                                []  
                         Memcpy DtoD (Device -> Device)         0.00%       0.000us         0.00%       0.000us       0.000us      13.848ms         0.06%      13.848ms      13.848ms           0 b           0 b           0 b           0 b             1                                                                                []  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       6.334ms         0.03%       6.334ms       6.334ms           0 b           0 b           0 b           0 b             1                                                                                []  
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      14.303ms         0.07%      14.303ms      14.303ms           0 b           0 b           0 b           0 b             1                                                                                []  
                                        Memset (Device)         0.00%       0.000us         0.00%       0.000us       0.000us       1.888us         0.00%       1.888us       1.888us           0 b           0 b           0 b           0 b             1                                                                                []  
void cutlass::Kernel<cutlass_80_simt_sgemm_128x256_8...         0.00%       0.000us         0.00%       0.000us       0.000us      41.945ms         0.19%      41.945ms      41.945ms           0 b           0 b           0 b           0 b             1                                                                                []  
                                         cudaEventQuery         0.00%       3.586us         0.00%       3.586us       3.586us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b             1                                                                                []  
                                         cudaEventQuery         0.00%       0.898us         0.00%       0.898us       0.898us     541.504us         0.00%     541.504us     541.504us           0 b           0 b           0 b           0 b             1                                                                                []  
                                         cudaEventQuery         0.00%       0.703us         0.00%       0.703us       0.703us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b             1                                                                                []  
                                         cudaEventQuery         0.00%       0.692us         0.00%       0.692us       0.692us     202.976us         0.00%     202.976us     202.976us           0 b           0 b           0 b           0 b             1                                                                                []  
                                         cudaEventQuery         0.00%       0.658us         0.00%       0.658us       0.658us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b             1                                                                                []  
                                         cudaEventQuery         0.00%       0.624us         0.00%       0.624us       0.624us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b             1                                                                                []  
                                         cudaEventQuery         0.00%       0.630us         0.00%       0.630us       0.630us       4.320us         0.00%       4.320us       4.320us           0 b           0 b           0 b           0 b             1                                                                                []  
                                         cudaEventQuery         0.00%       0.644us         0.00%       0.644us       0.644us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b             1                                                                                []  
                                         cudaEventQuery         0.00%       0.605us         0.00%       0.605us       0.605us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b             1                                                                                []  
                                         cudaEventQuery         0.00%       0.639us         0.00%       0.639us       0.639us       3.968us         0.00%       3.968us       3.968us           0 b           0 b           0 b           0 b             1                                                                                []  
                                         cudaEventQuery         0.00%       0.627us         0.00%       0.627us       0.627us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b             1                                                                                []  
                                         cudaEventQuery         0.00%       0.640us         0.00%       0.640us       0.640us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b             1                                                                                []  
                                         cudaEventQuery         0.00%       0.641us         0.00%       0.641us       0.641us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b             1                                                                                []  
                                        Memset (Device)         0.00%       0.000us         0.00%       0.000us       0.000us       1.312us         0.00%       1.312us       1.312us           0 b           0 b           0 b           0 b             1                                                                                []  
void cutlass::Kernel<cutlass_80_simt_sgemm_256x128_8...         0.00%       0.000us         0.00%       0.000us       0.000us      60.024ms         0.28%      60.024ms      60.024ms           0 b           0 b           0 b           0 b             1                                                                                []  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  --------------------------------------------------------------------------------  
Self CPU time total: 24.285s
Self CUDA time total: 21.783s
 on rank 0
0 <torch.profiler.profiler.profile object at 0x14729820b4a0>
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg       CPU Mem  Self CPU Mem      CUDA Mem  Self CUDA Mem    # of Calls  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                          ProfilerStep*         0.00%       0.000us         0.00%       0.000us       0.000us       21.337s        97.95%       21.337s        2.134s           0 b           0 b           0 b           0 b            10  
                        DistributedDataParallel.forward         0.00%       0.000us         0.00%       0.000us       0.000us        7.495s        34.41%        7.495s     374.737ms           0 b           0 b           0 b           0 b            20  
ncclDevKernel_AllReduce_Sum_f32_RING_LL(ncclDevComm*...         0.00%       0.000us         0.00%       0.000us       0.000us        5.655s        25.96%        5.655s      38.469ms           0 b           0 b           0 b           0 b           147  
                                               aten::mm         0.12%      29.031ms         0.19%      45.985ms      45.985us        5.366s        24.64%        5.366s       5.366ms           0 b           0 b      55.23 Gb      55.23 Gb          1000  
                                     record_param_comms         0.05%      11.843ms         3.94%     955.921ms       5.370ms        5.273s        24.21%        5.273s      29.623ms           0 b           0 b       2.00 Kb           0 b           178  
                                        nccl:all_reduce         0.00%       0.000us         0.00%       0.000us       0.000us        5.258s        24.14%        5.258s      39.239ms           0 b           0 b           0 b           0 b           134  
                                            aten::addmm         0.18%      42.651ms         0.29%      69.364ms      72.254us        2.376s        10.91%        2.376s       2.475ms           0 b           0 b      50.63 Gb      50.60 Gb           960  
void cutlass::Kernel<cutlass_80_simt_sgemm_256x128_8...         0.00%       0.000us         0.00%       0.000us       0.000us        2.002s         9.19%        2.002s       4.052ms           0 b           0 b           0 b           0 b           494  
                                              aten::mul         0.21%      49.817ms         0.38%      91.621ms      26.868us        1.856s         8.52%        1.856s     544.348us           0 b           0 b     171.56 Gb     171.47 Gb          3410  
                                ampere_sgemm_128x128_tn         0.00%       0.000us         0.00%       0.000us       0.000us        1.856s         8.52%        1.856s      88.369ms           0 b           0 b           0 b           0 b            21  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 24.285s
Self CUDA time total: 21.783s

Total Device Time: 125309.31 ms
Total CPU Time: 78568.03 ms
Validation:   0%|                                                                                                                                                             | 0/10 [00:00<?, ?it/s]Validation:  10%|██████████████▉                                                                                                                                      | 1/10 [00:00<00:04,  2.24it/s]Validation:  20%|█████████████████████████████▊                                                                                                                       | 2/10 [00:00<00:03,  2.53it/s]Validation:  30%|████████████████████████████████████████████▋                                                                                                        | 3/10 [00:01<00:02,  2.60it/s]Validation:  40%|███████████████████████████████████████████████████████████▌                                                                                         | 4/10 [00:01<00:02,  2.62it/s]Validation:  50%|██████████████████████████████████████████████████████████████████████████▌                                                                          | 5/10 [00:01<00:01,  2.64it/s]Validation:  60%|█████████████████████████████████████████████████████████████████████████████████████████▍                                                           | 6/10 [00:02<00:01,  2.64it/s]Validation:  70%|████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                            | 7/10 [00:02<00:01,  2.67it/s]Validation:  80%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                             | 8/10 [00:03<00:00,  2.66it/s]Validation:  90%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████               | 9/10 [00:03<00:00,  2.66it/s]Validation: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:03<00:00,  2.67it/s]Validation: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:03<00:00,  2.59it/s]
Final Validation loss: 2.283445429801941, Perplexity: 9.810423371699503
Final checkpoint saved at ./checkpoints/checkpoint-31Final checkpoint saved at ./checkpoints/checkpoint-31Final checkpoint saved at ./checkpoints/checkpoint-31


wandb:                                                                                
wandb:                                                                                
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:  iteration-time █▁
wandb:   learning-rate █▁
wandb:            loss █▁
wandb:    memory-usage ▁█
wandb:      perplexity █▁▁
wandb:      throughput ▁█
wandb: validation_loss █▁▁
wandb: 
wandb: Run summary:
wandb:  iteration-time 0.90734
wandb:   learning-rate 0
wandb:            loss 2.32046
wandb:    memory-usage 2407.52051
wandb:      perplexity 9.81042
wandb:      throughput 7.71438
wandb: validation_loss 2.28345
wandb: 
wandb: 
wandb: Run history:
wandb:  iteration-time █▁
wandb:   learning-rate █▁
wandb:            loss █▁
wandb:    memory-usage ▁█
wandb:      perplexity █▁▁
wandb:      throughput ▁█
wandb: validation_loss █▁▁
wandb: 
wandb: Run summary:
wandb:  iteration-time 0.90734
wandb:   learning-rate 0
wandb:            loss 2.32046
wandb:    memory-usage 2408.7832
wandb:      perplexity 9.81042
wandb:      throughput 7.71437
wandb: validation_loss 2.28345
wandb: 
wandb: 
wandb: Run history:
wandb:  iteration-time █▁
wandb:   learning-rate █▁
wandb:            loss █▁
wandb:    memory-usage ▁█
wandb:      perplexity █▁▁
wandb:      throughput ▁█
wandb: validation_loss █▁▁
wandb: 
wandb: Run summary:
wandb:  iteration-time 0.90734
wandb:   learning-rate 0
wandb:            loss 2.32046
wandb:    memory-usage 2407.52051
wandb:      perplexity 9.81042
wandb:      throughput 7.71438
wandb: validation_loss 2.28345
wandb: 
wandb: 🚀 View run glowing-dust-8 at: https://wandb.ai/ziyil0323/gpt2-benchmark%20ddp/runs/v095hv6b
wandb: ⭐️ View project at: https://wandb.ai/ziyil0323/gpt2-benchmark%20ddp
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20241208_084240-v095hv6b/logs
b-33-25:6464:6605 [2] NCCL INFO [Service thread] Connection closed by localRank 2
wandb: 🚀 View run stoic-cloud-6 at: https://wandb.ai/ziyil0323/gpt2-benchmark%20ddp/runs/zgo9lj6m
wandb: ⭐️ View project at: https://wandb.ai/ziyil0323/gpt2-benchmark%20ddp
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20241208_084240-zgo9lj6m/logs
wandb: 🚀 View run lucky-shadow-6 at: https://wandb.ai/ziyil0323/gpt2-benchmark%20ddp/runs/70rdgx6j
wandb: ⭐️ View project at: https://wandb.ai/ziyil0323/gpt2-benchmark%20ddp
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20241208_084239-70rdgx6j/logs
b-33-25:6463:6603 [1] NCCL INFO [Service thread] Connection closed by localRank 1
b-33-25:6465:6604 [3] NCCL INFO [Service thread] Connection closed by localRank 3
b-33-25:6464:8302 [2] NCCL INFO comm 0x56382c525e80 rank 2 nranks 4 cudaDev 2 busId 50 - Abort COMPLETE
b-33-25:6463:8303 [1] NCCL INFO comm 0x557c9fac8540 rank 1 nranks 4 cudaDev 1 busId 40 - Abort COMPLETE
b-33-25:6465:8304 [3] NCCL INFO comm 0x5580c708c780 rank 3 nranks 4 cudaDev 3 busId 60 - Abort COMPLETE
Final checkpoint saved at ./checkpoints/checkpoint-31
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:       iteration-time █▁
wandb:        learning-rate █▁
wandb:                 loss █▁
wandb:         memory-usage ▁█
wandb:           perplexity █▁▁
wandb:           throughput ▁█
wandb:    total_cpu_time_ms ▁
wandb: total_device_time_ms ▁
wandb:      validation_loss █▁▁
wandb: 
wandb: Run summary:
wandb:       iteration-time 0.90734
wandb:        learning-rate 0
wandb:                 loss 2.32046
wandb:         memory-usage 2407.57129
wandb:           perplexity 9.81042
wandb:           throughput 7.71439
wandb:    total_cpu_time_ms 78568.0329
wandb: total_device_time_ms 125309.30669
wandb:      validation_loss 2.28345
wandb: 
wandb: 🚀 View run silvery-snow-9 at: https://wandb.ai/ziyil0323/gpt2-benchmark%20ddp/runs/gkzb7hg4
wandb: ⭐️ View project at: https://wandb.ai/ziyil0323/gpt2-benchmark%20ddp
wandb: Synced 5 W&B file(s), 0 media file(s), 2 artifact file(s) and 1 other file(s)
wandb: Find logs at: ./wandb/run-20241208_084242-gkzb7hg4/logs
b-33-25:6462:6602 [0] NCCL INFO [Service thread] Connection closed by localRank 0
b-33-25:6462:8308 [0] NCCL INFO comm 0x55da8c205640 rank 0 nranks 4 cudaDev 0 busId 30 - Abort COMPLETE
